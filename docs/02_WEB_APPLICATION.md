# Documentation Part 2: Web Application (apps/web)

This document covers every file and folder in the Next.js 14 frontend application.

## Directory Structure

```
apps/web/
├── app/                    # Next.js App Router pages
├── components/             # React components
├── hooks/                  # Custom React hooks
├── lib/                    # Utility libraries
├── server/                 # tRPC server setup
├── stores/                 # Zustand state management
├── public/                 # Static assets
├── tests/                  # Test files
├── packages/               # Local solana package reference
├── Dockerfile              # Docker build config
├── middleware.ts           # Next.js middleware
├── next.config.js          # Next.js configuration
├── next-env.d.ts           # Next.js TypeScript definitions
├── package.json            # Dependencies and scripts
├── playwright.config.ts    # E2E test configuration
├── postcss.config.js       # PostCSS configuration
├── tailwind.config.js      # Tailwind CSS configuration
├── tsconfig.json           # TypeScript configuration
├── tsconfig.tsbuildinfo    # TypeScript build cache
└── vitest.config.ts        # Unit test configuration
```

---

## Configuration Files

### `package.json`
**Purpose**: Web app dependencies and scripts.

**Key Dependencies**:
- `next`: Next.js 14 framework
- `react`, `react-dom`: React library
- `@trpc/*`: tRPC for type-safe APIs
- `@supabase/*`: Supabase authentication
- `@monaco-editor/react`: Code editor
- `zustand`: State management
- `framer-motion`, `gsap`: Animations
- `@radix-ui/*`: UI components

**Scripts**:
- `dev`: Start development server
- `build`: Production build
- `start`: Start production server
- `lint`: ESLint
- `type-check`: TypeScript checking
- `test`: Unit tests
- `test:e2e`: Playwright E2E tests

**If removed**: Application would not run, dependencies undefined.

---

### `next.config.js`
**Purpose**: Next.js configuration.

**Key Settings**:
- `transpilePackages`: Transpiles workspace packages
- `output: "standalone"`: For Docker deployment
- `images.remotePatterns`: Allows Google profile images
- `experimental.outputFileTracingRoot`: Includes Solana templates in build

**If removed**: Next.js would use defaults, template bundling might fail.

---

### `middleware.ts`
**Purpose**: Next.js middleware for authentication and routing.

**What it does**:
- Creates Supabase client for server-side auth
- Refreshes user session on each request
- Redirects authenticated users away from landing/auth pages
- Applies to: `/`, `/dashboard/*`, `/playground/*`, `/my-code/*`, `/auth/*`

**If removed**:
- Authentication would not work server-side
- Session refresh would fail
- Redirects would not work

---

### `tsconfig.json`
**Purpose**: TypeScript configuration for web app.

**What it does**:
- Extends shared config from `@solana-playground/config-tsconfig`
- Sets paths alias (`@/*` → `./`)
- Configures Next.js types

**If removed**: TypeScript would not compile, type checking would fail.

---

### `tailwind.config.js`
**Purpose**: Tailwind CSS configuration.

**What it does**:
- Extends shared Tailwind config
- Defines custom theme colors
- Configures content paths for purging

**If removed**: Tailwind styles would not work, UI would break.

---

### `postcss.config.js`
**Purpose**: PostCSS configuration for CSS processing.

**What it does**:
- Processes CSS with Tailwind and Autoprefixer
- Required for Tailwind to work

**If removed**: CSS would not be processed, styles would fail.

---

### `playwright.config.ts`
**Purpose**: Playwright E2E test configuration.

**What it does**:
- Configures browser testing
- Sets up test environment
- Defines test patterns

**If removed**: E2E tests would not run.

---

### `vitest.config.ts`
**Purpose**: Vitest unit test configuration.

**What it does**:
- Configures test environment (jsdom)
- Sets up React Testing Library
- Defines test file patterns

**If removed**: Unit tests would not run.

---

### `next-env.d.ts`
**Purpose**: Next.js TypeScript definitions (auto-generated).

**What it does**:
- Provides Next.js type definitions
- Auto-generated by Next.js

**If removed**: TypeScript errors for Next.js types, can regenerate.

---

### `tsconfig.tsbuildinfo`
**Purpose**: TypeScript incremental build cache.

**What it does**:
- Speeds up TypeScript compilation
- Caches type information

**If removed**: Slower builds, can regenerate.

---

### `Dockerfile`
**Purpose**: Docker build configuration for web app.

**What it does**:
- Multi-stage build (deps → builder → runner)
- Installs pnpm and dependencies
- Builds Next.js app
- Creates standalone production image

**If removed**: Docker builds would fail, deployment would break.

---

## App Directory (`app/`)

Next.js 13+ App Router structure. Each folder/file represents a route.

### `app/layout.tsx`
**Purpose**: Root layout component.

**What it does**:
- Wraps all pages with Providers
- Sets up ErrorBoundary
- Includes Analytics and SpeedInsights
- Defines metadata (title, icons)

**If removed**: App would not render, no root layout.

---

### `app/page.tsx`
**Purpose**: Landing page (`/` route).

**What it does**:
- Renders landing page with Hero, ProductDemo, etc.
- Shows navigation and auth button
- Client component

**If removed**: Landing page would not exist, root route would fail.

---

### `app/globals.css`
**Purpose**: Global CSS styles.

**What it does**:
- Imports Tailwind directives
- Defines global styles
- Custom CSS variables

**If removed**: Styles would be missing, UI would be unstyled.

---

### `app/providers.tsx`
**Purpose**: React context providers wrapper.

**What it does**:
- Sets up tRPC provider
- Configures React Query
- Wraps app with necessary providers

**If removed**: tRPC and React Query would not work.

---

### `app/error.tsx`
**Purpose**: Error boundary for app directory.

**What it does**:
- Catches errors in app directory
- Displays error UI

**If removed**: Errors would not be caught gracefully.

---

### `app/global-error.tsx`
**Purpose**: Global error boundary.

**What it does**:
- Catches errors in root layout
- Last resort error handler

**If removed**: Root errors would crash app.

---

### `app/landing/page.tsx`
**Purpose**: Alternative landing page route.

**What it does**:
- Additional landing page route
- May redirect or show different content

**If removed**: `/landing` route would 404.

---

### `app/login/page.tsx`
**Purpose**: Login page.

**What it does**:
- Displays login form
- Handles authentication UI

**If removed**: Login page would not exist.

---

### `app/signup/page.tsx`
**Purpose**: Signup page.

**What it does**:
- Displays signup form
- Handles user registration

**If removed**: Signup page would not exist.

---

### `app/dashboard/page.tsx`
**Purpose**: User dashboard.

**What it does**:
- Shows user's progress and stats
- Displays saved code and templates

**If removed**: Dashboard route would 404.

---

### `app/playground/page.tsx`
**Purpose**: Playground index page.

**What it does**:
- Lists available playground templates
- Template selection interface

**If removed**: Playground index would not exist.

---

### `app/playground/[templateId]/page.tsx`
**Purpose**: Individual playground template page.

**What it does**:
- Renders playground for specific template
- Code editor and execution interface

**If removed**: Individual playground routes would 404.

---

### `app/(playground)/[templateId]/page.tsx`
**Purpose**: Route group for playground (alternative structure).

**What it does**:
- Alternative playground route structure
- May be legacy or alternative implementation

**If removed**: Alternative playground routes would fail.

---

### `app/my-code/page.tsx`
**Purpose**: User's saved code page.

**What it does**:
- Lists user's saved code snippets
- Code management interface

**If removed**: User code page would not exist.

---

### `app/templates/page.tsx`
**Purpose**: Templates listing page.

**What it does**:
- Shows all available templates
- Template browser

**If removed**: Templates page would not exist.

---

### `app/templates/[templateId]/page.tsx`
**Purpose**: Individual template detail page.

**What it does**:
- Shows template details and code
- Template information

**If removed**: Template detail routes would 404.

---

### `app/concepts/[conceptId]/page.tsx`
**Purpose**: Learning concept page.

**What it does**:
- Displays learning concept details
- Educational content

**If removed**: Concept pages would 404.

---

### `app/paths/page.tsx`
**Purpose**: Learning paths page.

**What it does**:
- Shows learning paths/curriculum
- Path selection

**If removed**: Learning paths page would not exist.

---

### `app/instructor/page.tsx`
**Purpose**: Instructor dashboard.

**What it does**:
- Instructor-specific interface
- Teaching tools

**If removed**: Instructor page would not exist.

---

### `app/cohorts/join/page.tsx`
**Purpose**: Cohort joining page.

**What it does**:
- Allows users to join cohorts
- Cohort management

**If removed**: Cohort joining would not work.

---

### `app/styleguide/page.tsx`
**Purpose**: Style guide page.

**What it does**:
- Shows UI component examples
- Design system reference

**If removed**: Style guide would not be accessible.

---

### `app/auth/callback/route.ts`
**Purpose**: OAuth callback handler.

**What it does**:
- Handles OAuth redirects from providers
- Exchanges code for session
- Redirects to playground

**If removed**: OAuth authentication would fail.

---

### `app/auth/auth-code-error/page.tsx`
**Purpose**: OAuth error page.

**What it does**:
- Displays OAuth errors
- Error handling UI

**If removed**: OAuth errors would not be displayed.

---

### `app/actions/ai.ts`
**Purpose**: Server actions for AI features.

**What it does**:
- Server-side AI operations
- AI tutor functionality

**If removed**: AI features would not work server-side.

---

### `app/api/execute/route.ts`
**Purpose**: API route for code execution.

**What it does**:
- Handles execution requests
- Proxies to runner service

**If removed**: Code execution API would not work.

---

### `app/api/templates/route.ts`
**Purpose**: API route for templates list.

**What it does**:
- Returns list of templates
- Template metadata

**If removed**: Template API would not work.

---

### `app/api/templates/[id]/route.ts`
**Purpose**: API route for individual template.

**What it does**:
- Returns template by ID
- Template data

**If removed**: Individual template API would fail.

---

### `app/api/templates/[id]/explain/route.ts`
**Purpose**: API route for code explanations.

**What it does**:
- Returns code explanations
- AI-powered explanations

**If removed**: Code explanations would not work.

---

### `app/api/trpc/[trpc]/route.ts`
**Purpose**: tRPC API handler.

**What it does**:
- Handles tRPC requests
- Type-safe API endpoint

**If removed**: tRPC would not work, API calls would fail.

---

## Components Directory (`components/`)

### `components/landing/`
**Purpose**: Landing page components.

**Files**:
- `Hero.tsx`: Hero section
- `ProductDemo.tsx`: Product demonstration
- `WhySwitch.tsx`: Why switch section
- `HowItWorks.tsx`: How it works explanation
- `Examples.tsx`: Example showcase
- `Trust.tsx`: Trust indicators
- `FinalCTA.tsx`: Final call-to-action
- `Footer.tsx`: Footer component
- `UsedBy.tsx`: Used by section
- `animations.ts`: Animation utilities

**If removed**: Landing page would be broken.

---

### `components/panels/`
**Purpose**: Playground panel components.

**Files**:
- `CodePanel.tsx`: Code editor panel
- `ExecutionPanel.tsx`: Execution results panel
- `StatePanel.tsx`: Account state panel
- `MapPanel.tsx`: Program map visualization
- `AccountInspectorPanel.tsx`: Account inspection
- `CallStackPanel.tsx`: Call stack visualization
- `FlowPanel.tsx`: Flow diagram
- `TransactionBuilder.tsx`: Transaction builder
- `ExecutionControl.tsx`: Execution controls
- `WatchPanel.tsx`: Variable watching
- `ProgramChecklistPanel.tsx`: Program checklist
- `AccountDiagram.tsx`: Account diagram

**If removed**: Playground panels would not work.

---

### `components/exercises/`
**Purpose**: Exercise components.

**Files**:
- `CodeChallenge.tsx`: Code challenge UI
- `ExercisePanel.tsx`: Exercise panel
- `FillInBlank.tsx`: Fill-in-the-blank exercise
- `Quiz.tsx`: Quiz component

**If removed**: Exercise features would not work.

---

### `components/learning/`
**Purpose**: Learning path components.

**Files**:
- `LearningPath.tsx`: Learning path display
- `PathProgress.tsx`: Progress tracking
- `ConceptGraph.tsx`: Concept visualization
- `RelatedConcepts.tsx`: Related concepts
- `FirstTxWizard.tsx`: First transaction wizard

**If removed**: Learning features would not work.

---

### `components/ai/`
**Purpose**: AI tutor components.

**Files**:
- `AITutor.tsx`: AI tutor interface
- `ContextualHints.tsx`: Contextual hints

**If removed**: AI features would not work.

---

### `components/auth/`
**Purpose**: Authentication components.

**Files**:
- `AuthButton.tsx`: Auth button component
- `LoginModal.tsx`: Login modal
- `ProtectedRoute.tsx`: Route protection
- `LandingRedirect.tsx`: Landing redirect logic

**If removed**: Authentication UI would break.

---

### `components/ui/`
**Purpose**: Reusable UI components.

**Files**:
- `Badge.tsx`: Badge component
- `Toast.tsx`: Toast notifications
- `Tooltip.tsx`: Tooltip component
- `LoadingSpinner.tsx`: Loading spinner
- `ResizablePanels.tsx`: Resizable panel layout
- `CommandPalette.tsx`: Command palette
- `HelpIcon.tsx`: Help icon
- `FlowChart.tsx`: Flow chart visualization
- `AccountGraph.tsx`: Account graph
- `StateDiff.tsx`: State difference display
- `StateTimeline.tsx`: State timeline
- `StatusIndicator.tsx`: Status indicator

**If removed**: UI components would be missing, app would break.

---

### `components/dashboard/`
**Purpose**: Dashboard components.

**Files**:
- `UserMenu.tsx`: User menu dropdown

**If removed**: Dashboard UI would be incomplete.

---

### `components/providers/`
**Purpose**: Context providers.

**Files**:
- `AuthProvider.tsx`: Authentication provider

**If removed**: Auth context would not work.

---

### Other Components:
- `ErrorBoundary.tsx`: Error boundary wrapper
- `Logo.tsx`: Logo component
- `ProgramSidebar.tsx`: Program sidebar
- `TemplateHeader.tsx`: Template header

---

## Hooks Directory (`hooks/`)

### `hooks/use-active-program.ts`
**Purpose**: Hook for active program state.

**If removed**: Active program tracking would fail.

---

### `hooks/use-keyboard-shortcuts.ts`
**Purpose**: Keyboard shortcuts hook.

**If removed**: Keyboard shortcuts would not work.

---

### `hooks/use-templates.ts`
**Purpose**: Templates data hook.

**If removed**: Template fetching would break.

---

### `hooks/use-toast.ts`
**Purpose**: Toast notification hook.

**If removed**: Toast notifications would not work.

---

### `hooks/useAutoSave.ts`
**Purpose**: Auto-save functionality hook.

**If removed**: Auto-save would not work.

---

### `hooks/useDebounce.ts`
**Purpose**: Debounce utility hook.

**If removed**: Debounced operations would fail.

---

## Libraries Directory (`lib/`)

### `lib/supabase.ts`
**Purpose**: Supabase client setup.

**If removed**: Database and auth would not work.

---

### `lib/trpc-client.ts`
**Purpose**: tRPC client configuration.

**If removed**: tRPC calls would fail.

---

### `lib/monaco-setup.ts`
**Purpose**: Monaco editor configuration.

**If removed**: Code editor would not work.

---

### `lib/error-decoder.ts`
**Purpose**: Solana error decoding.

**If removed**: Error messages would be unclear.

---

### `lib/program-types.ts`
**Purpose**: Program type definitions.

**If removed**: Type safety would be lost.

---

### `lib/analytics.ts`
**Purpose**: Analytics utilities.

**If removed**: Analytics would not work.

---

### `lib/utils.ts`
**Purpose**: General utilities.

**If removed**: Utility functions would be missing.

---

## Server Directory (`server/`)

### `server/trpc.ts`
**Purpose**: tRPC server setup.

**If removed**: tRPC server would not work.

---

### `server/context.ts`
**Purpose**: tRPC context creation.

**If removed**: tRPC context would be missing.

---

### `server/routers/`
**Purpose**: tRPC routers.

**Files**:
- `_app.ts`: App router
- `auth.ts`: Authentication router
- `code.ts`: Code management router
- `profile.ts`: Profile router
- `template.ts`: Template router

**If removed**: tRPC endpoints would not work.

---

## Stores Directory (`stores/`)

Zustand state management stores.

### `stores/execution.ts`
**Purpose**: Execution state.

**If removed**: Execution state would be lost.

---

### `stores/layout.ts`
**Purpose**: Layout state.

**If removed**: Layout preferences would not persist.

---

### `stores/playground.ts`
**Purpose**: Playground state.

**If removed**: Playground state would be lost.

---

### `stores/programs.ts`
**Purpose**: Program state.

**If removed**: Program state would be lost.

---

### `stores/settings.ts`
**Purpose**: Settings state.

**If removed**: Settings would not persist.

---

### `stores/transaction.ts`
**Purpose**: Transaction state.

**If removed**: Transaction state would be lost.

---

### `stores/learning-path.ts`
**Purpose**: Learning path state.

**If removed**: Learning path progress would be lost.

---

## Public Directory (`public/`)

### `public/logo/`
**Purpose**: Logo and branding images.

**Files**:
- Various PNG logo files
- Icon files

**If removed**: Logos would not display, broken images.

---

## Tests Directory (`tests/`)

### `tests/e2e/`
**Purpose**: End-to-end tests (Playwright).

**Files**:
- `home.spec.ts`: Home page tests
- `landing.spec.ts`: Landing page tests
- `playground.spec.ts`: Playground tests
- `styleguide.spec.ts`: Style guide tests

**If removed**: E2E tests would not run.

---

### `tests/unit/`
**Purpose**: Unit tests (Vitest).

**Files**:
- Various component and page tests

**If removed**: Unit tests would not run.

---

### `tests/setup.ts`
**Purpose**: Test setup configuration.

**If removed**: Tests would not initialize properly.

---

### `tests/example.test.tsx`
**Purpose**: Example test file.

**If removed**: Example test would be missing.

---

## Summary

**Critical Files**:
- `package.json`, `next.config.js`, `middleware.ts` - Core configuration
- `app/layout.tsx`, `app/page.tsx` - Root pages
- `components/` - All UI components
- `server/` - tRPC setup

**Important Files**:
- `stores/` - State management
- `hooks/` - Reusable logic
- `lib/` - Utilities
- `tests/` - Testing

**Can Remove** (with impact):
- `test-results/` - Test output (regeneratable)
- `tsconfig.tsbuildinfo` - Build cache (regeneratable)
- Individual component files (would break specific features)

