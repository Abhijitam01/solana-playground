[
  {"line": 1, "type": "import", "summary": "Import Anchor prelude types and macros."},
  {"line": 2, "type": "import", "summary": "Import SPL Token CPI types for authority rotation."},
  {"line": 3, "type": "import", "summary": "Import the SPL Token AuthorityType enum."},
  {"line": 5, "type": "macro", "summary": "Declare the program ID for authority rotation."},
  {"line": 7, "type": "macro", "summary": "Mark the module as the program entrypoint."},
  {"line": 8, "type": "module", "summary": "Define the token authority rotation program module."},
  {"line": 9, "type": "import", "summary": "Bring module items into scope."},
  {"line": 11, "type": "instruction", "summary": "Initialize the rotation state with the current authority."},
  {"line": 12, "type": "logic", "summary": "Get a mutable reference to the rotation state."},
  {"line": 13, "type": "state", "summary": "Store the current authority pubkey."},
  {"line": 14, "type": "log", "summary": "Log that the rotation state is initialized."},
  {"line": 15, "type": "logic", "summary": "Return success from initialize."},
  {"line": 16, "type": "logic", "summary": "End of initialize instruction."},
  {"line": 18, "type": "instruction", "summary": "Rotate the mint authority using SPL Token CPI."},
  {"line": 19, "type": "security", "summary": "Ensure the signer matches the stored authority.", "risk": "Unauthorized authority changes."},
  {"line": 20, "type": "security", "summary": "Compare the signer to the stored authority."},
  {"line": 21, "type": "logic", "summary": "Return Unauthorized if the check fails."},
  {"line": 22, "type": "logic", "summary": "End the require! macro invocation."},
  {"line": 23, "type": "logic", "summary": "Prepare CPI accounts for set_authority."},
  {"line": 24, "type": "account", "summary": "Provide the current authority account to CPI."},
  {"line": 25, "type": "account", "summary": "Provide the mint account to CPI."},
  {"line": 26, "type": "logic", "summary": "Close the CPI account struct initialization."},
  {"line": 27, "type": "logic", "summary": "Build the CPI context for the token program."},
  {"line": 28, "type": "instruction", "summary": "Invoke SPL Token set_authority."},
  {"line": 29, "type": "instruction", "summary": "Pass the CPI context to the instruction."},
  {"line": 30, "type": "instruction", "summary": "Set the authority type to MintTokens."},
  {"line": 31, "type": "instruction", "summary": "Provide the new authority pubkey."},
  {"line": 32, "type": "instruction", "summary": "Close the CPI invocation and handle errors."},
  {"line": 33, "type": "state", "summary": "Persist the new authority in state."},
  {"line": 34, "type": "log", "summary": "Log the authority rotation."},
  {"line": 35, "type": "logic", "summary": "Return success from rotate_mint_authority."},
  {"line": 36, "type": "logic", "summary": "End of rotate_mint_authority instruction."},
  {"line": 37, "type": "logic", "summary": "End of program module."},
  {"line": 39, "type": "account", "summary": "Define the accounts context for initialize."},
  {"line": 40, "type": "account", "summary": "Declare the Initialize accounts struct."},
  {"line": 41, "type": "account", "summary": "Initialize rotation state with payer and space."},
  {"line": 42, "type": "account", "summary": "Rotation state account to store authority."},
  {"line": 43, "type": "account", "summary": "Mark the current authority signer as mutable."},
  {"line": 44, "type": "account", "summary": "Current authority signer pays for initialization."},
  {"line": 45, "type": "account", "summary": "System program for account creation."},
  {"line": 46, "type": "account", "summary": "End of Initialize accounts struct."},
  {"line": 48, "type": "account", "summary": "Define the accounts context for rotate_mint_authority."},
  {"line": 49, "type": "account", "summary": "Declare the RotateAuthority accounts struct."},
  {"line": 50, "type": "account", "summary": "Rotation state must be mutable for updates."},
  {"line": 51, "type": "account", "summary": "Rotation state account holding authority data."},
  {"line": 52, "type": "account", "summary": "Mint account whose authority will change."},
  {"line": 53, "type": "account", "summary": "Mint account is mutable for authority update."},
  {"line": 54, "type": "account", "summary": "Current authority signer authorizes the CPI."},
  {"line": 55, "type": "account", "summary": "Current authority must sign the transaction."},
  {"line": 56, "type": "account", "summary": "New authority account to set on the mint."},
  {"line": 57, "type": "account", "summary": "Token program used for CPI."},
  {"line": 58, "type": "account", "summary": "End of RotateAuthority accounts struct."},
  {"line": 60, "type": "account", "summary": "Mark this struct as on-chain account data."},
  {"line": 61, "type": "account", "summary": "Define the rotation state layout."},
  {"line": 62, "type": "state", "summary": "Pubkey of the current mint authority."},
  {"line": 63, "type": "account", "summary": "End of the RotationState struct."},
  {"line": 65, "type": "logic", "summary": "Define helper constants for RotationState."},
  {"line": 66, "type": "logic", "summary": "Compute the byte size of RotationState."},
  {"line": 67, "type": "logic", "summary": "End of RotationState impl."},
  {"line": 69, "type": "logic", "summary": "Define program-specific error codes."},
  {"line": 70, "type": "logic", "summary": "Declare the error enum."},
  {"line": 71, "type": "logic", "summary": "Attach a message for Unauthorized."},
  {"line": 72, "type": "logic", "summary": "Unauthorized error variant."},
  {"line": 73, "type": "logic", "summary": "End of the error enum."}
]
