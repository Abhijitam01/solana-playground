flowchart TD
    initialize["Initialize Account"] --> state["Create State Account"]
    state --> setAuthority["Set Authority"]
    setAuthority --> unfrozen["Set Frozen to False"]
    unfrozen --> initializeDone["Initialization Complete"]
    rotateAuthority["Rotate Authority"] --> checkAuthority["Check Current Authority"]
    checkAuthority --> checkFrozen["Check if Frozen"]
    checkFrozen -.-> rotateFailed["Rotation Failed: Unauthorized or Frozen"]
    checkFrozen --> rotateSuccess["Rotate Authority"]
    rotateSuccess --> updateAuthority["Update State Authority"]
    updateAuthority --> rotateDone["Rotation Complete"]
    freezeAuthority["Freeze Authority"] --> checkAuthority2["Check Current Authority"]
    checkAuthority2 --> freezeSuccess["Freeze State Authority"]
    freezeSuccess --> updateFrozen["Update Frozen to True"]
    updateFrozen --> freezeDone["Freeze Complete"]