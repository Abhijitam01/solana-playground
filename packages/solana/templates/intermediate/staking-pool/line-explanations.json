[
  {"line":1,"type":"macro","summary":"Import Anchor prelude types and macros.","why":"Provides Context, Result, and account helpers.","concepts":["Anchor"]},
  {"line":3,"type":"macro","summary":"Declare the program ID.","why":"Identifies the on-chain program.","concepts":["Program ID"]},
  {"line":5,"type":"macro","summary":"Mark the module as the Anchor program entry point.","concepts":["Instructions"]},
  {"line":6,"type":"instruction","summary":"Define the program module namespace.","concepts":["Program Structure"]},
  {"line":7,"type":"logic","summary":"Bring parent symbols into scope.","concepts":["Rust Modules"]},

  {"line":9,"type":"instruction","summary":"Define the initialize_pool instruction handler.","why":"Creates the staking pool account.","concepts":["Staking","Instructions"]},
  {"line":10,"type":"logic","summary":"Create a mutable reference to the pool account.","concepts":["Accounts"]},
  {"line":11,"type":"logic","summary":"Store the pool authority key.","concepts":["Authority"]},
  {"line":12,"type":"logic","summary":"Initialize total staked to zero.","concepts":["State"]},
  {"line":13,"type":"logic","summary":"Initialize total shares to zero.","concepts":["State"]},
  {"line":14,"type":"logic","summary":"Store the pool PDA bump.","concepts":["PDA","Bump"]},
  {"line":15,"type":"macro","summary":"Log pool initialization.","concepts":["Logs"]},
  {"line":16,"type":"logic","summary":"Return success from initialize_pool.","concepts":["Result"]},
  {"line":17,"type":"logic","summary":"End of initialize_pool handler.","concepts":["Rust"]},

  {"line":19,"type":"instruction","summary":"Define the deposit instruction handler.","why":"Deposits lamports and mints shares.","concepts":["Staking"]},
  {"line":20,"type":"security","summary":"Validate a non-zero deposit amount.","concepts":["Validation"]},
  {"line":21,"type":"logic","summary":"Create a mutable reference to the pool account.","concepts":["Accounts"]},
  {"line":22,"type":"logic","summary":"Create a mutable reference to the stake account.","concepts":["Accounts"]},

  {"line":24,"type":"logic","summary":"Start share calculation based on pool state.","concepts":["Staking","Math"]},
  {"line":25,"type":"logic","summary":"If the pool is empty, mint 1:1 shares.","concepts":["Staking"]},
  {"line":26,"type":"logic","summary":"Return the amount as shares for first deposit.","concepts":["Staking"]},
  {"line":27,"type":"logic","summary":"Otherwise, compute proportional shares.","concepts":["Staking","Math"]},
  {"line":28,"type":"logic","summary":"Multiply deposit by total shares.","concepts":["Math"]},
  {"line":29,"type":"logic","summary":"Divide by total staked to maintain ratio.","concepts":["Math"]},
  {"line":30,"type":"security","summary":"Convert math overflow into an error.","concepts":["Error Handling"]},
  {"line":31,"type":"logic","summary":"End share calculation.","concepts":["Math"]},

  {"line":33,"type":"logic","summary":"Transfer lamports into the pool account.","concepts":["Lamports"]},
  {"line":34,"type":"logic","summary":"Debit lamports from the staker.","concepts":["Lamports"]},

  {"line":36,"type":"logic","summary":"Increase total staked safely.","concepts":["Safe Math"]},
  {"line":37,"type":"logic","summary":"Increase total shares safely.","concepts":["Safe Math"]},
  {"line":38,"type":"logic","summary":"Record stake owner.","concepts":["Accounts"]},
  {"line":39,"type":"logic","summary":"Increase staker shares safely.","concepts":["Safe Math"]},

  {"line":41,"type":"macro","summary":"Log deposit and share minting.","concepts":["Logs"]},
  {"line":42,"type":"logic","summary":"Return success from deposit.","concepts":["Result"]},
  {"line":43,"type":"logic","summary":"End of deposit handler.","concepts":["Rust"]},

  {"line":45,"type":"instruction","summary":"Define the withdraw instruction handler.","why":"Burns shares and returns lamports.","concepts":["Staking"]},
  {"line":46,"type":"security","summary":"Validate a non-zero withdrawal.","concepts":["Validation"]},
  {"line":47,"type":"logic","summary":"Create a mutable reference to the pool.","concepts":["Accounts"]},
  {"line":48,"type":"logic","summary":"Create a mutable reference to the stake account.","concepts":["Accounts"]},
  {"line":49,"type":"security","summary":"Ensure the staker owns the stake account.","concepts":["Access Control"]},
  {"line":50,"type":"security","summary":"Ensure the staker has enough shares.","concepts":["Validation"]},

  {"line":52,"type":"logic","summary":"Start share-to-lamport conversion.","concepts":["Staking","Math"]},
  {"line":53,"type":"logic","summary":"Multiply shares by total staked.","concepts":["Math"]},
  {"line":54,"type":"logic","summary":"Divide by total shares to get lamports.","concepts":["Math"]},
  {"line":55,"type":"security","summary":"Convert math overflow into an error.","concepts":["Error Handling"]},

  {"line":57,"type":"logic","summary":"Transfer lamports out of the pool account.","concepts":["Lamports"]},
  {"line":58,"type":"logic","summary":"Credit lamports to the staker.","concepts":["Lamports"]},

  {"line":60,"type":"logic","summary":"Decrease total staked safely.","concepts":["Safe Math"]},
  {"line":61,"type":"logic","summary":"Decrease total shares safely.","concepts":["Safe Math"]},
  {"line":62,"type":"logic","summary":"Decrease staker shares safely.","concepts":["Safe Math"]},

  {"line":64,"type":"macro","summary":"Log withdrawal details.","concepts":["Logs"]},
  {"line":65,"type":"logic","summary":"Return success from withdraw.","concepts":["Result"]},
  {"line":66,"type":"logic","summary":"End of withdraw handler.","concepts":["Rust"]},
  {"line":67,"type":"logic","summary":"End of program module.","concepts":["Rust Modules"]},

  {"line":69,"type":"macro","summary":"Derive account validation for InitializePool.","concepts":["Accounts"]},
  {"line":70,"type":"account","summary":"Define accounts required to initialize the pool.","concepts":["Accounts"]},
  {"line":71,"type":"account","summary":"Begin pool initialization constraints.","concepts":["Account Initialization"]},
  {"line":72,"type":"account","summary":"Initialize the pool account.","concepts":["Account Initialization"]},
  {"line":73,"type":"account","summary":"Set authority as the payer.","concepts":["Payer"]},
  {"line":74,"type":"account","summary":"Set the pool account size.","concepts":["Account Size"]},
  {"line":75,"type":"account","summary":"Derive the pool PDA seeds.","concepts":["PDA"]},
  {"line":76,"type":"account","summary":"Capture the pool PDA bump.","concepts":["PDA","Bump"]},
  {"line":77,"type":"account","summary":"End pool initialization constraints.","concepts":["Accounts"]},
  {"line":78,"type":"account","summary":"Pool account.","concepts":["Accounts"]},
  {"line":79,"type":"account","summary":"Mark authority mutable for rent and fees.","concepts":["Signer","Payer"]},
  {"line":80,"type":"account","summary":"Authority signer account.","concepts":["Signer"]},
  {"line":81,"type":"account","summary":"System Program account.","concepts":["System Program"]},
  {"line":82,"type":"logic","summary":"End of InitializePool accounts struct.","concepts":["Accounts"]},

  {"line":84,"type":"macro","summary":"Derive account validation for Deposit.","concepts":["Accounts"]},
  {"line":85,"type":"account","summary":"Define accounts required to deposit.","concepts":["Accounts"]},
  {"line":86,"type":"account","summary":"Pool account with PDA constraint.","concepts":["PDA"]},
  {"line":87,"type":"account","summary":"Pool account passed in.","concepts":["Accounts"]},
  {"line":88,"type":"account","summary":"Begin stake account initialization constraints.","concepts":["Account Initialization"]},
  {"line":89,"type":"account","summary":"Initialize the stake account.","concepts":["Account Initialization"]},
  {"line":90,"type":"account","summary":"Set staker as the payer.","concepts":["Payer"]},
  {"line":91,"type":"account","summary":"Set the stake account size.","concepts":["Account Size"]},
  {"line":92,"type":"account","summary":"Derive the stake account PDA seeds.","concepts":["PDA"]},
  {"line":93,"type":"account","summary":"Capture the stake account bump.","concepts":["PDA","Bump"]},
  {"line":94,"type":"account","summary":"End stake account initialization constraints.","concepts":["Accounts"]},
  {"line":95,"type":"account","summary":"Stake account.","concepts":["Accounts"]},
  {"line":96,"type":"account","summary":"Mark staker mutable for lamports.","concepts":["Signer","Mutability"]},
  {"line":97,"type":"account","summary":"Staker signer account.","concepts":["Signer"]},
  {"line":98,"type":"account","summary":"Document unchecked authority seed account.","concepts":["Unchecked Accounts"]},
  {"line":99,"type":"account","summary":"Authority account used for PDA seeds.","concepts":["PDA"]},
  {"line":100,"type":"account","summary":"System Program account.","concepts":["System Program"]},
  {"line":101,"type":"logic","summary":"End of Deposit accounts struct.","concepts":["Accounts"]},

  {"line":103,"type":"macro","summary":"Derive account validation for Withdraw.","concepts":["Accounts"]},
  {"line":104,"type":"account","summary":"Define accounts required to withdraw.","concepts":["Accounts"]},
  {"line":105,"type":"account","summary":"Pool account with PDA constraint.","concepts":["PDA"]},
  {"line":106,"type":"account","summary":"Pool account passed in.","concepts":["Accounts"]},
  {"line":107,"type":"account","summary":"Stake account with PDA constraint.","concepts":["PDA"]},
  {"line":108,"type":"account","summary":"Stake account passed in.","concepts":["Accounts"]},
  {"line":109,"type":"account","summary":"Mark staker mutable for lamports.","concepts":["Signer","Mutability"]},
  {"line":110,"type":"account","summary":"Staker signer account.","concepts":["Signer"]},
  {"line":111,"type":"account","summary":"Document unchecked authority seed account.","concepts":["Unchecked Accounts"]},
  {"line":112,"type":"account","summary":"Authority account used for PDA seeds.","concepts":["PDA"]},
  {"line":113,"type":"logic","summary":"End of Withdraw accounts struct.","concepts":["Accounts"]},

  {"line":115,"type":"macro","summary":"Mark Pool as an account.","concepts":["Accounts"]},
  {"line":116,"type":"account","summary":"Define the Pool state struct.","concepts":["Accounts"]},
  {"line":117,"type":"account","summary":"Authority of the pool.","concepts":["Authority"]},
  {"line":118,"type":"account","summary":"Total lamports staked.","concepts":["Lamports"]},
  {"line":119,"type":"account","summary":"Total shares minted.","concepts":["Staking"]},
  {"line":120,"type":"account","summary":"Pool PDA bump.","concepts":["PDA","Bump"]},
  {"line":121,"type":"logic","summary":"End of Pool struct.","concepts":["Accounts"]},

  {"line":123,"type":"logic","summary":"Implement helper constants for Pool.","concepts":["Rust"]},
  {"line":124,"type":"logic","summary":"Define the serialized size of Pool.","concepts":["Account Size"]},
  {"line":125,"type":"logic","summary":"End of Pool impl block.","concepts":["Rust"]},

  {"line":127,"type":"macro","summary":"Mark StakeAccount as an account.","concepts":["Accounts"]},
  {"line":128,"type":"account","summary":"Define the StakeAccount state struct.","concepts":["Accounts"]},
  {"line":129,"type":"account","summary":"Owner of the stake account.","concepts":["Access Control"]},
  {"line":130,"type":"account","summary":"Shares owned by the staker.","concepts":["Staking"]},
  {"line":131,"type":"logic","summary":"End of StakeAccount struct.","concepts":["Accounts"]},

  {"line":133,"type":"logic","summary":"Implement helper constants for StakeAccount.","concepts":["Rust"]},
  {"line":134,"type":"logic","summary":"Define the serialized size of StakeAccount.","concepts":["Account Size"]},
  {"line":135,"type":"logic","summary":"End of StakeAccount impl block.","concepts":["Rust"]},

  {"line":137,"type":"macro","summary":"Start custom error definitions.","concepts":["Errors"]},
  {"line":138,"type":"logic","summary":"Define the ErrorCode enum.","concepts":["Errors"]},
  {"line":139,"type":"macro","summary":"Message for invalid amount.","concepts":["Errors"]},
  {"line":140,"type":"security","summary":"Error when amount is zero.","concepts":["Validation"]},
  {"line":141,"type":"macro","summary":"Message for math overflow.","concepts":["Errors"]},
  {"line":142,"type":"security","summary":"Error when math overflows.","concepts":["Validation","Math"]},
  {"line":143,"type":"macro","summary":"Message for unauthorized staker.","concepts":["Errors"]},
  {"line":144,"type":"security","summary":"Error when staker is not the owner.","concepts":["Access Control"]},
  {"line":145,"type":"macro","summary":"Message for insufficient shares.","concepts":["Errors"]},
  {"line":146,"type":"security","summary":"Error when shares are insufficient.","concepts":["Validation"]},
  {"line":147,"type":"logic","summary":"End of ErrorCode enum.","concepts":["Errors"]}
]
